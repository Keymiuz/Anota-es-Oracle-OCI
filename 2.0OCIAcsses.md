# Fundamentos do OCI Identity and Access Management (IAM)

O serviço de IAM permite controlar quem tem acesso aos seus recursos na nuvem, que tipo de acesso um grupo de usuários possui e a quais recursos específicos.

## Conceitos Chave: Autenticação vs. Autorização

* **Autenticação (AuthN):** O processo de verificar **quem** um usuário é.
* **Autorização (AuthZ):** O processo de definir **o que** um usuário autenticado tem permissão para fazer.


## Componentes Principais do IAM

* **Identity Domains (Domínios de Identidade):** Contêineres para usuários e grupos. Representam uma população de usuários no OCI com suas configurações de segurança associadas.
* **Users (Usuários):** Indivíduos ou sistemas que gerenciam recursos.
* **Principals (Entidades):** Podem ser usuários do IAM ou "Resource Principals" (recursos que agem em nome de outros, como uma instância de computação).
* **Groups (Grupos):** Coleções de usuários que precisam do mesmo tipo de acesso. As permissões são concedidas a grupos, não a usuários individuais.
* **Dynamic Groups (Grupos Dinâmicos):** A associação a esses grupos é determinada dinamicamente por regras que você define. Se um recurso corresponder à regra, ele entra no grupo automaticamente.
* **Policies (Políticas):** Definem a autorização (o que é permitido). São escritas em um formato legível por humanos.
* **Compartments (Compartimentos):** Coleções de recursos relacionados. Usados para isolamento de segurança e controle de acesso.
* **Resource (Recurso):** Qualquer objeto na nuvem, como uma Virtual Cloud Network (VCN) ou uma instância de computação.
* **Federation (Federação):** Permite integrar o OCI com um provedor de identidade externo (como Azure AD, Okta). O gerenciamento de usuários e grupos é feito no provedor de identidade.
* **Network Sources (Fontes de Rede):** Um grupo de endereços IP definidos que podem ser usados em políticas avançadas para restringir o acesso apenas a solicitações originadas desses IPs.


## Funcionamento e Princípios do IAM

1.  **Fluxo de Trabalho:**
    1.  Crie um **Identity Domain**.
    2.  Crie **Users** e **Groups** dentro desse domínio.
    3.  Escreva **Policies** para conceder permissões aos **Groups**.

2.  **Princípio do Menor Privilégio (Least Privilege):**
    * Por padrão, o acesso no OCI é negado. Tudo o que não é explicitamente permitido por uma política é bloqueado.
    * Portanto, as políticas **sempre concedem permissões (`allow`)**, nunca negam (`deny`).


## Sintaxe das Políticas (Policies)

As políticas são a base da autorização no OCI. A sintaxe é estruturada da seguinte forma:

`Allow <subject> to <verb> <resource-type> in <location> where <conditions>`

* **`Allow`**: Todas as políticas começam com `Allow`.
* **`<subject>` (Sujeito):** O grupo (ou grupos) que receberá a permissão.
    * Pode ser especificado pelo nome ou OCID.
    * Exemplo: `group NetworkAdmins`
    * Se o domínio de identidade não for especificado (ex: `domain MyDomain/group Admins`), a política assume o domínio padrão.
* **`<verb>` (Verbo):** O tipo de acesso. Existem quatro níveis:
    1.  `inspect`: Listar recursos sem ver seus metadados.
    2.  `read`: `inspect` + ver os metadados do recurso.
    3.  `use`: `read` + trabalhar com os recursos (ex: iniciar/parar uma instância). Não permite criar ou deletar.
    4.  `manage`: Todas as permissões sobre o recurso (criar, ler, atualizar, deletar).
* **`<resource-type>` (Tipo de Recurso):** O recurso que a política afeta.
    * Pode ser um tipo individual (`vcns`, `volumes`).
    * Pode ser um tipo de família (`virtual-network-family`), que inclui vários recursos relacionados.
* **`<location>` (Localização):** Onde a política se aplica.
    * Pode ser um único compartimento (`compartment Network`).
    * Pode ser a tenancy inteira (`tenancy`), aplicando-se a todos os compartimentos.
* **`<conditions>` (Condições):** Cláusulas avançadas para refinar a política.
    * Exemplo: `where request.networkSource.name = 'corp_network'`


## Compartimentos (Compartments)

Compartimentos são um recurso poderoso para **isolamento de segurança e controle de acesso**.

* **Tenancy (Root Compartment):** Ao criar uma conta OCI, você recebe uma "tenancy", que é o compartimento raiz. Ele pode conter todos os recursos da nuvem.
* **Compartimentos Dedicados:** A **melhor prática** é criar compartimentos dedicados para organizar e isolar recursos.
    * **Exemplo:**
        * **Compartimento `Network`:** Contém recursos de rede como VCNs e Load Balancers.
        * **Compartimento `Storage`:** Contém recursos de armazenamento como Object Storage e Block Volumes.
    * A ideia é agrupar recursos relacionados para aplicar políticas de acesso granulares e simplificar o gerenciamento.
