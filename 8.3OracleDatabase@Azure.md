# HA e DR no Oracle Database@Azure

## Gerenciamento de Backups Automáticos

A funcionalidade de backups automáticos é habilitada facilmente através das ferramentas da nuvem (OCI Console) e oferece uma base sólida para a recuperação de dados.

* **Habilitação:** Ativado com um clique na interface do OCI.
* **Destino:** Os backups são armazenados em um bucket **OCI Object Storage Standard** gerenciado pela Oracle.
* **Resiliência:** Os backups são **espelhados em três vias** para alta durabilidade:
    * Em regiões com múltiplos ADs, as cópias são distribuídas entre os ADs.
    * Em regiões com um único AD, as cópias são distribuídas entre os Fault Domains.
* **Agendamento:**
    * **Full Backups:** Você escolhe o dia da semana e a janela de horário.
    * **Incremental Backups:** Ocorrem nos outros dias, na janela de horário definida.
    * **Archived Redo Logs:** São enviados para backup a cada 30 minutos.
* **Retenção:** A política de retenção pode ser definida para **7, 15, 30 ou 60 dias**.
* **Disponibilidade em RAC:** Em um ambiente RAC, se um nó estiver indisponível, o backup será executado automaticamente em outro nó disponível.
* **Em Ambientes Data Guard:** Você pode configurar os backups para serem tirados do banco de dados primário, do standby, ou de ambos.
* **Restauração (Restore):**
    * **Container Database (CDB):** A restauração completa do CDB é totalmente automatizada via console e pode ser para o último backup, para um ponto no tempo (Point-in-Time) ou para um SCN específico.
    * **Pluggable Database (PDB):** A restauração de um único PDB é feita via linha de comando (`dbaascli`).

## Oracle Data Guard e Active Data Guard

O Data Guard é a principal tecnologia da Oracle para recuperação de desastres (DR), garantindo proteção de dados e tempo mínimo de recuperação.

* **Automação:** A configuração do Data Guard é **totalmente automatizada** através da interface do OCI, seguindo as melhores práticas da **Maximum Availability Architecture (MAA)** da Oracle por padrão.
* **Operações Automatizadas:** As operações de **switchover** e **failover** também podem ser executadas com um clique na console.
* **Limitação da Automação:** O setup automatizado suporta a criação de **um** banco de dados standby. Múltiplos standbys podem ser configurados manualmente.
* **Active Data Guard:** É a licença opcional que habilita funcionalidades avançadas:
    * Reparo automático de blocos corrompidos.
    * **Offload de cargas de trabalho de leitura** para o banco de dados standby.
    * Permite a execução de DMLs ocasionais no standby.

## Arquiteturas de Disaster Recovery (DR)

### 1. Cross-Availability Zone (Standby Local)
* **Finalidade:** Alta disponibilidade dentro da mesma região, protegendo contra falhas em um data center (AD).
* **Arquitetura:**
    * O banco de dados primário e o standby rodam em infraestruturas Exadata em **diferentes Availability Zones** na mesma região.
    * **Fast-Start Failover (FSFO):** Para automatizar o failover, instale o **Observer** em um terceiro AD ou na rede da aplicação para monitorar a configuração e iniciar o failover automaticamente.

### 2. Cross-Region (Standby Remoto)
* **Finalidade:** Recuperação de desastres completa, protegendo contra eventos que afetam uma região inteira.
* **Arquitetura:**
    * O banco de dados primário e o standby rodam em infraestruturas Exadata em **regiões geográficas diferentes**.
    * **Replicação de Chaves:** As chaves de criptografia TDE armazenadas no OCI Vault precisam ser replicadas entre as regiões.
    * **Aplicação:** A aplicação também deve ser replicada na região de DR para garantir a continuidade dos negócios após um failover.

### 3. Hybrid Disaster Recovery (On-Premises para Oracle Database@Azure)
* **Finalidade:** Proteger um banco de dados on-premises usando um standby na nuvem (Oracle Database@Azure).
* **Requisito:** Suportado a partir do Oracle Database 19.16, que permite a mistura de bancos de dados não-TDE (on-premises) com bancos de dados TDE (nuvem).
* **Automação:** A Oracle recomenda o uso da ferramenta **Zero Downtime Migration (ZDM)** para automatizar a configuração do Data Guard híbrido.