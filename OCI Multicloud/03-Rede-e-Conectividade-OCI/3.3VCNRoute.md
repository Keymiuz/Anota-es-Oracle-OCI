# Roteamento na Virtual Cloud Network (VCN)

## Quando Usar Tabelas de Rota?

Você precisa de uma **Tabela de Rota (Route Table)** e de **Regras de Rota (Route Rules)** sempre que precisar enviar tráfego para **fora da sua VCN**. Para utilizar os gateways de rede (Internet, NAT, DRG, etc.), você deve criar uma regra de rota que os aponte como o alvo.

### Tráfego Dentro da VCN

* **Não é necessário criar regras de rota** para o tráfego que permanece **dentro da mesma VCN** (por exemplo, entre duas sub-redes).
* O OCI gerencia esse tráfego interno automaticamente como parte da estrutura da VCN.

## Princípios Chave do Roteamento

1.  **Precedência da Rota Mais Específica:**
    * Se uma tabela de rotas tiver regras sobrepostas, a regra **mais específica** (com o prefixo CIDR mais longo) terá preferência.
    * **Exemplo:**
        * Regra 1: `192.168.0.0/16` -> via Dynamic Routing Gateway (DRG)
        * Regra 2: `192.168.1.0/24` -> via Local Peering Gateway (LPG)
    * Se um recurso tentar acessar `192.168.1.4`, o tráfego será enviado pela **Regra 2** (via LPG), porque `/24` é mais específico que `/16`.

2.  **Sem Rota Correspondente (No Matching Route):**
    * Se o tráfego é destinado a um endereço fora da VCN e não há uma regra de rota que corresponda a esse destino, o pacote será **descartado**.

3.  **Suporte a IPv6:**
    * O roteamento IPv6 é suportado em todas as regiões comerciais e governamentais.


## Componentes de uma Regra de Rota

Cada regra em uma tabela de rotas consiste em dois componentes principais:

* **Destination (Destino):** Para onde o tráfego está indo.
* **Route Target (Alvo da Rota):** O "próximo salto" (next hop) ou o gateway que será usado para alcançar o destino.

### O Caso Especial do Service Gateway

Diferente dos outros gateways, o alvo de uma regra para o Service Gateway não é o gateway em si, mas sim o serviço da Oracle que você deseja alcançar. As opções são:

* **All `<region>` Object Storage:** Para tráfego destinado especificamente ao Object Storage.
* **All `<region>` Services in Oracle Services Network:** Para todos os outros serviços públicos do OCI (como Autonomous Data Warehouse, OCI Console, etc.).