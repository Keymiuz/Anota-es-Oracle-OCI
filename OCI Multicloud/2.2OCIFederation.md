# Conceitos de Federação no OCI

## Termos Fundamentais

Para entender a federação de identidade, é preciso conhecer dois termos principais:

* **Identity Provider (IdP) - Provedor de Identidade:**
    * É o serviço que fornece as credenciais de identificação e realiza a autenticação dos usuários.
    * Exemplo: Azure Active Directory, Okta, ADFS.

* **Service Provider (SP) - Provedor de Serviço:**
    * É o serviço ou aplicação que depende de um Provedor de Identidade para autenticar seus usuários.
    * Exemplo: O Console do Oracle Cloud Infrastructure (OCI).

## O que é Federação de Identidade?

**Federação** é o processo onde um Provedor de Serviço (SP) delega a autenticação de um usuário para um Provedor de Identidade (IdP).

**Benefício Principal:** Em vez de criar um novo usuário e senha para acessar os recursos do OCI, os administradores podem federar o OCI com o IdP da empresa. Isso permite que cada funcionário use seu login e senha existentes (SSO - Single Sign-On).

**Como funciona?** O administrador estabelece uma relação de confiança entre o IdP e o OCI. Esse processo é comumente conhecido como **Federation Trust**.


## Protocolo e Conceitos Técnicos

* **Protocolo Suportado:** OCI pode ser federado com qualquer IdP que suporte o protocolo **SAML 2.0 (Security Assertion Markup Language)**. SAML é um padrão baseado em XML para trocar informações de autenticação e autorização entre o IdP e o SP.

* **Conceitos Importantes:**
    * **Federation Trust:** A relação de confiança configurada pelo administrador entre o IdP e o SP.
    * **SAML Metadata Document (Documento de Metadados SAML):** Um documento XML fornecido pelo IdP que contém as informações necessárias para que o SP (OCI) possa se federar com ele.
    * **Metadata URL (URL de Metadados):** Uma URL fornecida pelo IdP que aponta para o Documento de Metadados SAML. O SP a utiliza para obter as informações de configuração.

## Tipos de Usuários

* **Federated User (Usuário Federado):**
    * Um usuário que faz login no console do OCI através de um Provedor de Identidade federado. A autenticação ocorre no IdP.

* **Local User (Usuário Local):**
    * Um usuário não federado que faz login no console do OCI com um nome de usuário e senha criados e gerenciados diretamente no OCI.

## Fluxo de Funcionamento da Federação (Exemplo)

Vamos supor que um usuário queira acessar uma aplicação (SP) que requer autenticação.

1.  **Acesso à Aplicação:** O usuário navega até a URL da aplicação do Provedor de Serviço (SP).
2.  **Redirecionamento para o IdP:** O SP detecta que o usuário não está autenticado e o redireciona para a página de login do Provedor de Identidade (IdP).
3.  **Autenticação do Usuário:** O usuário insere suas credenciais (login e senha) na página do IdP.
4.  **Validação e Token:** O IdP valida as credenciais. Se estiverem corretas, o usuário é autenticado e recebe um **token de acesso** (uma "afirmação" SAML).
5.  **Retorno à Aplicação:** O navegador do usuário é redirecionado de volta para a aplicação (SP), levando consigo o token de acesso. A aplicação valida o token e concede acesso ao usuário.

Este foi o fim da lição sobre os conceitos de Federação.