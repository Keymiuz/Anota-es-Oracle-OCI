# Processo de Configuração do OCI-Azure Interconnect

## Arquitetura da Conexão

A conexão cross-cloud entre OCI e Azure é estabelecida entre um circuito **FastConnect** no OCI e um circuito **ExpressRoute** no Azure.

* **Lado do OCI:** O tráfego passa por uma VCN, que está conectada a um **Dynamic Routing Gateway (DRG)**. O circuito FastConnect termina no DRG.
* **Lado do Azure:** O tráfego passa por uma VNet (Virtual Network), que está conectada a um **Virtual Network Gateway**. O circuito ExpressRoute termina neste gateway.
* **Fluxo:** O tráfego flui entre o DRG (OCI) e o Virtual Network Gateway (Azure), permanecendo sempre em uma rede privada.

## Processo de Configuração em 6 Passos

1.  **Planejamento de Segurança:**
    * Determine qual tráfego precisa fluir entre as sub-redes da VCN (OCI) e da VNet (Azure).
    * Com base nisso, configure as **Security Lists** e/ou **Network Security Groups** em ambas as nuvens para permitir esse tráfego.

2.  **Configurar o ExpressRoute (no Azure):**
    * Inicie o processo no portal do Azure para configurar um circuito ExpressRoute para se conectar ao "Oracle Cloud FastConnect".
    * Ao final deste passo, o Azure fornecerá uma **Chave de Serviço (Service Key)**. **Anote esta chave**, pois ela é essencial para o próximo passo.

3.  **Configurar o FastConnect (no OCI):**
    * No console do OCI, crie um circuito virtual privado do FastConnect.
    * Durante a configuração, você fornecerá a **Chave de Serviço** obtida do Azure.
    * Aguarde o provisionamento do circuito.

4.  **Verificar o Status da Conexão:**
    * **No OCI:** Confirme que o status do circuito virtual FastConnect está "UP" (Ativo).
    * **No Azure:** Confirme que o status do circuito ExpressRoute foi atualizado e que o "private peering" está provisionado e habilitado.

5.  **Configurar o Roteamento:**
    * Determine quais sub-redes na VCN (OCI) precisam se comunicar com a VNet (Azure) e vice-versa.
    * Configure as **Tabelas de Rota** em ambas as nuvens para direcionar o tráfego destinado à outra nuvem para o respectivo gateway (DRG no OCI, Virtual Network Gateway no Azure).

6.  **Testar a Conexão:**
    * Crie uma instância (VM) em cada nuvem.
    * Tente acessar a instância do OCI a partir da instância do Azure (e vice-versa), usando seus endereços IP privados.
    * Se o teste for bem-sucedido, a interconexão está pronta para uso.

## Detalhes Técnicos da Configuração

* **Roteamento com BGP:** A conexão utiliza o protocolo BGP (Border Gateway Protocol) para o roteamento dinâmico.
* **Endereços IP para BGP:** Você precisa fornecer **dois pares** de endereços IP para as duas sessões BGP redundantes.
    * **Par Primário:** Um IP para o lado Oracle, um IP para o lado Azure.
    * **Par Secundário:** Um IP para o lado Oracle, um IP para o lado Azure.
* **Alocação de Endereços:**
    * Para cada par, você deve fornecer um bloco de endereços com máscara de `/28` a `/31`.
    * O OCI e o Azure usarão automaticamente o **segundo e o terceiro endereços** de cada bloco fornecido para a sessão BGP. (Ex: se você fornecer `10.0.0.0/30`, o OCI usará `10.0.0.1` e o Azure usará `10.0.0.2`).

## Redundância e Custos

* **Redundância Integrada:** Cada circuito de interconexão já é construído sobre **dois links físicos redundantes** no mesmo ponto de presença, mas em roteadores físicos diferentes, garantindo alta disponibilidade. Para proteção contra desastres regionais, você pode construir uma segunda interconexão em outra região.
* **Custos:**
    * O preço é baseado apenas nas **taxas de porta** do OCI FastConnect e do Azure ExpressRoute.
    * **Não há cobranças separadas por transferência de dados (ingress/egress)** sobre a conexão.
    * O custo do FastConnect é o mesmo em todas as regiões do OCI.
    * O custo do Azure ExpressRoute varia entre as regiões. A Oracle recomenda usar a configuração "Local" do ExpressRoute, que também não tem cobranças de dados.
* **Largura de Banda (Bandwidth):**
    * O ExpressRoute suporta até 10 Gbps.
    * O FastConnect está disponível em 1, 2, 5 ou 10 Gbps.
    * **Recomendação:** Escolha uma das opções de largura de banda correspondentes em ambos os serviços para garantir um desempenho consistente.